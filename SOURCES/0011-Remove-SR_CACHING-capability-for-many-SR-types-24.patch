From cf100e50b862b6cb9cc7a4baa9d555f16ab915cf Mon Sep 17 00:00:00 2001
From: Ronan Abhamon <ronan.abhamon@gmail.com>
Date: Thu, 23 Jun 2022 10:37:07 +0200
Subject: [PATCH] Remove SR_CACHING capability for many SR types (#24)

SR_CACHING offers the capacity to use IntelliCache, but this
feature is only available using NFS SR.

For more details, the implementation of `_setup_cache` in blktap2.py
uses only an instance of NFSFileVDI for the shared target.

Signed-off-by: Ronan Abhamon <ronan.abhamon@vates.fr>
---
 drivers/CephFSSR.py    | 2 +-
 drivers/GlusterFSSR.py | 2 +-
 drivers/MooseFSSR.py   | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

Index: sm-3.2.12/drivers/CephFSSR.py
===================================================================
--- sm-3.2.12.orig/drivers/CephFSSR.py
+++ sm-3.2.12/drivers/CephFSSR.py
@@ -38,7 +38,7 @@ import vhdutil
 import xs_errors
 from lock import Lock
 
-CAPABILITIES = ["SR_PROBE", "SR_UPDATE", "SR_CACHING",
+CAPABILITIES = ["SR_PROBE", "SR_UPDATE",
                 "VDI_CREATE", "VDI_DELETE", "VDI_ATTACH", "VDI_DETACH",
                 "VDI_UPDATE", "VDI_CLONE", "VDI_SNAPSHOT", "VDI_RESIZE", "VDI_MIRROR",
                 "VDI_GENERATE_CONFIG",
Index: sm-3.2.12/drivers/GlusterFSSR.py
===================================================================
--- sm-3.2.12.orig/drivers/GlusterFSSR.py
+++ sm-3.2.12/drivers/GlusterFSSR.py
@@ -35,7 +35,7 @@ import vhdutil
 import xs_errors
 from lock import Lock
 
-CAPABILITIES = ["SR_PROBE", "SR_UPDATE", "SR_CACHING",
+CAPABILITIES = ["SR_PROBE", "SR_UPDATE",
                 "VDI_CREATE", "VDI_DELETE", "VDI_ATTACH", "VDI_DETACH",
                 "VDI_UPDATE", "VDI_CLONE", "VDI_SNAPSHOT", "VDI_RESIZE", "VDI_MIRROR",
                 "VDI_GENERATE_CONFIG",
Index: sm-3.2.12/drivers/MooseFSSR.py
===================================================================
--- sm-3.2.12.orig/drivers/MooseFSSR.py
+++ sm-3.2.12/drivers/MooseFSSR.py
@@ -39,7 +39,7 @@ import vhdutil
 import xs_errors
 from lock import Lock
 
-CAPABILITIES = ["SR_PROBE", "SR_UPDATE", "SR_CACHING",
+CAPABILITIES = ["SR_PROBE", "SR_UPDATE",
                 "VDI_CREATE", "VDI_DELETE", "VDI_ATTACH", "VDI_DETACH",
                 "VDI_UPDATE", "VDI_CLONE", "VDI_SNAPSHOT", "VDI_RESIZE", "VDI_MIRROR",
                 "VDI_GENERATE_CONFIG",
