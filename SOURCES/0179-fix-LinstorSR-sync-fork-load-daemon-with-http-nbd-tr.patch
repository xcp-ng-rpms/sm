From 2031020847e5f8f69bc5ed855e3bbaee7ea2975a Mon Sep 17 00:00:00 2001
From: Ronan Abhamon <ronan.abhamon@vates.fr>
Date: Thu, 9 Jan 2025 17:42:46 +0100
Subject: [PATCH] fix(LinstorSR): sync fork-load-daemon with http-nbd-transfer
 (v1.5.0) (#74)

Signed-off-by: Ronan Abhamon <ronan.abhamon@vates.fr>
---
 scripts/fork-log-daemon | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/scripts/fork-log-daemon b/scripts/fork-log-daemon
index 665a60ba..debbc893 100755
--- a/scripts/fork-log-daemon
+++ b/scripts/fork-log-daemon
@@ -1,5 +1,6 @@
 #!/usr/bin/env python
 
+import os
 import select
 import signal
 import subprocess
@@ -7,7 +8,12 @@ import sys
 import syslog
 
 def main():
-    process = subprocess.Popen(sys.argv[1:], stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
+    process = subprocess.Popen(
+        sys.argv[1:],
+        stdout=subprocess.PIPE,
+        stderr=subprocess.STDOUT,
+        env=dict(os.environ, PYTHONUNBUFFERED='1')
+    )
     signal.signal(signal.SIGTERM, signal.SIG_IGN)
     write_to_stdout = True
 
